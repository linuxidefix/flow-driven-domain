{
  "actions": [
    {
      "name": "CHECK_INV",
      "delegate": "checkInventoryDelegate"
    },
    {
      "name": "RECHECK_INV",
      "delegate": "checkInventoryDelegate"
    },
    {
      "name": "DEBIT",
      "delegate": "debitDelegate"
    },
    {
      "name": "SHIP",
      "delegate": "shipDelegate"
    },
    {
      "name": "DELIVER",
      "delegate": "deliverDelegate"
    },
    {
      "name": "NOTIFY",
      "delegate": "notifyDelegate"
    }
  ],
  "states": [
    {
      "name": "NEW",
      "initial": true,
      "transitions": [
        {
          "action": "CHECK_INV",
          "result": {
            "inventoryOK": "P_DEBIT",
            "inventoryKO": "P_INVENTORY"
          },
          "timer": {
            "sec": 0
          }
        }
      ]
    },
    {
      "name": "P_INVENTORY",
      "transitions": [
        {
          "action": "RECHECK_INV",
          "result": {
            "inventoryOK": "P_DEBIT",
            "inventoryKO": "P_INVENTORY"
          },
          "retry": {
            "number": 3,
            "exceeded": "CANCELLED"
          },
          "timer": {
            "sec": 5
          }
        }
      ]
    },
    {
      "name": "P_DEBIT",
      "transitions": [
        {
          "action": "DEBIT",
          "result": {
            "success": "P_SHIPMENT",
            "error": "CANCELLED"
          },
          "retry": {
            "number": 3,
            "exceeded": "CANCELLED"
          },
          "timer": {
            "sec": 0
          }
        }
      ]
    },
    {
      "name": "P_SHIPMENT",
      "transitions": [
        {
          "action": "SHIP",
          "result": {
            "success": "SHIPPED"
          }
        }
      ]
    },
    {
      "name": "SHIPPED",
      "transitions": [
        {
          "action": "DELIVER",
          "result": {
            "success": "DELIVERED"
          }
        },
        {
          "action": "NOTIFY",
          "result": {
            "success": "DELIVERY_UNKNOWN"
          },
          "timer": {
            "sec": 60
          }
        }
      ]
    },
    {
      "name": "DELIVERED",
      "transitions": []
    },
    {
      "name": "CANCELLED",
      "transitions": []
    },
    {
      "name": "DELIVERY_UNKNOWN",
      "transitions": []
    }
  ]
}